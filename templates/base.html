<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="{% block meta_description %}Gorilla Camping - Guerilla-style camping guides, gear reviews, and off-grid living tips for budget-conscious adventurers.{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}guerilla camping, off-grid living, camping gear reviews, budget camping, DIY camping, veteran camping{% endblock %}">
    <meta name="author" content="Jon - Gorilla Camping">
    <title>{% block title %}Gorilla Camping - Guerilla-Style Camping & Off-Grid Living{% endblock %}</title>
    
    <!-- CookieYes - MUST BE FIRST FOR COMPLIANCE -->
    <script id="cookieyes" type="text/javascript" src="https://cdn-cookieyes.com/client_data/f9240018d9682ec755f25926/script.js"></script>
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://gorillacamping.site{{ request.path }}">
    
    <!-- Favicon - Complete Set -->
    <link rel="apple-touch-icon" sizes="180x180" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ url_for('static', filename='favicon-32x32.png') }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ url_for('static', filename='favicon-16x16.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='site.webmanifest') }}">
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">

    <!-- Social Meta Tags -->
    <meta property="og:title" content="{% block og_title %}{{ self.title() }}{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ self.meta_description() }}{% endblock %}">
    <meta property="og:image" content="https://gorillacamping.site{{ url_for('static', filename='images/og-gorilla-camping.jpg') }}">
    <meta property="og:url" content="https://gorillacamping.site{{ request.path }}">
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:site_name" content="Gorilla Camping">
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ self.title() }}">
    <meta name="twitter:description" content="{{ self.meta_description() }}">
    <meta name="twitter:image" content="https://gorillacamping.site{{ url_for('static', filename='images/og-gorilla-camping.jpg') }}">

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Gorilla Camping",
      "url": "https://gorillacamping.site",
      "logo": "https://gorillacamping.site{{ url_for('static', filename='images/logo.png') }}",
      "description": "Guerilla-style camping guides, gear reviews, and off-grid living tips for budget-conscious adventurers.",
      "founder": {
        "@type": "Person",
        "name": "Jon",
        "description": "Army veteran and off-grid camping enthusiast"
      },
      "sameAs": [
        "https://www.reddit.com/r/gorillacamping",
        "https://www.facebook.com/gorillacamping",
        "https://www.tiktok.com/@gorillacamping"
      ]
    }
    </script>

    {% block extra_head %}{% endblock %}

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JPKKPRXX6S"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-JPKKPRXX6S');
      
      // Enhanced affiliate tracking
      function trackAffiliateClick(affiliateUrl, productName) {
        gtag('event', 'affiliate_click', {
          'event_category': 'Affiliate',
          'event_label': affiliateUrl,
          'custom_parameter_1': productName
        });
      }
      
      // Social click tracking
      function trackSocialClick(platform, action) {
        gtag('event', 'social_click', {
          'event_category': 'Social',
          'event_label': platform,
          'custom_parameter_1': action
        });
      }
    </script>

    <!-- Microsoft Clarity -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "rprq55166f");
    </script>

    <!-- MailerLite Universal -->
    <script>
        (function(w,d,e,u,f,l,n){w[f]=w[f]||function(){(w[f].q=w[f].q||[])
        .push(arguments);},l=d.createElement(e),l.async=1,l.src=u,
        n=d.getElementsByTagName(e)[0],n.parentNode.insertBefore(l,n);})
        (window,document,'script','https://assets.mailerlite.com/js/universal.js','ml');
        ml('account', '1500893');
    </script>
</head>
<body>
    <header class="gc-header">
        <div class="logo-container">
            <a href="/" aria-label="Gorilla Camping Home">
                <img src="{{ url_for('static', filename='images/logo.png') }}"
                     alt="Gorilla Camping Logo - Guerilla Style Camping"
                     class="header-logo-glow"
                     width="140"
                     height="140">
            </a>
        </div>
        <h1 class="gc-motto-glow">Life is short, just camp through it!</h1>
        <nav class="gc-nav" role="navigation" aria-label="Main Navigation">
            <a href="/" {% if request.path=='/' %}class="active" aria-current="page"{% endif %}>Home</a>
            <a href="/blog" {% if request.path.startswith('/blog') %}class="active" aria-current="page"{% endif %}>Blog</a>
            <a href="/gear" {% if request.path=='/gear' %}class="active" aria-current="page"{% endif %}>Gear</a>
            <a href="/about" {% if request.path=='/about' %}class="active" aria-current="page"{% endif %}>About</a>
            <a href="/contact" {% if request.path=='/contact' %}class="active" aria-current="page"{% endif %}>Contact</a>
        </nav>
    </header>

    <main role="main">
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-messages">
              {% for category, message in messages %}
                <div class="flash flash-{{ category }}" role="alert">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </main>

    <footer class="gc-footer">
        <div class="footer-content">
            <!-- GUERILLA SOCIAL SECTION -->
            <div class="social-links">
                <h3>Join the Guerilla Tribe</h3>
                <div class="social-icons">
                    <a href="{{ url_for('social_redirect', platform='reddit') }}" 
                       class="social-link reddit" 
                       onclick="trackSocialClick('reddit', 'footer_click')"
                       aria-label="Join us on Reddit">
                        <!-- Reddit SVG here -->
                        Reddit
                    </a>
                    
                    <a href="{{ url_for('social_redirect', platform='facebook') }}" 
                       class="social-link facebook" 
                       onclick="trackSocialClick('facebook', 'footer_click')"
                       aria-label="Follow us on Facebook">
                        <!-- Facebook SVG here -->
                        Facebook
                    </a>
                    
                    <a href="{{ url_for('social_redirect', platform='tiktok') }}" 
                       class="social-link tiktok" 
                       onclick="trackSocialClick('tiktok', 'footer_click')"
                       aria-label="Follow us on TikTok">
                        <!-- TikTok SVG here -->
                        TikTok
                    </a>
                </div>
            </div>
            
           <!-- Floating AI Assistant Button -->
<button id="ai-assistant-button" class="btn btn-success rounded-circle shadow-lg" title="Guerilla AI Assistant" style="position:fixed; bottom:20px; right:20px; width:60px; height:60px; font-size:24px; z-index:1050;">
    üß†
</button>

<!-- AI Modal -->
<div class="modal fade" id="aiOptimizerModal" tabindex="-1" aria-labelledby="aiModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="aiModalLabel">ü¶ç Guerilla Mission Control</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p class="lead">Input your parameters to get an instant, personalized mission brief from the AI.</p>
        <div class="row">
            <div class="col-md-6">
                <form id="optimizer-modal-form">
                    <h6>Camping Style:</h6>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="stealth" id="m-stealth"><label class="form-check-label" for="m-stealth">Stealth</label></div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="fishing" id="m-fishing"><label class="form-check-label" for="m-fishing">Fishing</label></div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="budget" id="m-budget"><label class="form-check-label" for="m-budget">Budget-Focused</label></div>
                    <h6 class="mt-3">Your Gear:</h6>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="coleman-stove" id="m-coleman-stove"><label class="form-check-label" for="m-coleman-stove">Coleman Stove</label></div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="lifestraw-filter" id="m-lifestraw-filter"><label class="form-check-label" for="m-lifestraw-filter">LifeStraw Filter</label></div>
                    <div class="form-check"><input class="form-check-input" type="checkbox" value="jackery-explorer-240" id="m-jackery"><label class="form-check-label" for="m-jackery">Power Station</label></div>
                </form>
            </div>
            <div class="col-md-6">
                 <h6>Mission Briefing:</h6>
                 <div id="modal-results-container" class="p-3 bg-light rounded" style="min-height: 200px;">
                    <p>Your analysis will appear here.</p>
                 </div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" id="modal-optimize-btn">üöÄ Optimize Now</button>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap 5 CDN (if not already loaded) -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const aiButton = document.getElementById('ai-assistant-button');
    const aiModal = new bootstrap.Modal(document.getElementById('aiOptimizerModal'));
    const optimizeBtn = document.getElementById('modal-optimize-btn');
    const resultsContainer = document.getElementById('modal-results-container');
    const form = document.getElementById('optimizer-modal-form');

    aiButton.addEventListener('click', function() {
        aiModal.show();
    });

    optimizeBtn.addEventListener('click', async function() {
        resultsContainer.innerHTML = '<p>The AI is thinking...</p>';
        const preferences = Array.from(form.querySelectorAll('input[type="checkbox"]:checked'))
                                 .map(el => el.value)
                                 .filter(val => ['stealth', 'fishing', 'budget'].includes(val));
        const gear = Array.from(form.querySelectorAll('input[type="checkbox"]:checked'))
                          .map(el => el.value)
                          .filter(val => !['stealth', 'fishing', 'budget'].includes(val));
        const pageContext = window.location.pathname;
        const payload = { preferences, gear, page_context: pageContext };
        try {
            const response = await fetch('/api/optimize', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const result = await response.json();
            if (result.success) {
                let html = '';
                if (result.warnings && result.warnings.length > 0) {
                    html += '<h6>‚ö†Ô∏è Warnings</h6><ul class="list-group">';
                    result.warnings.forEach(w => { html += `<li class="list-group-item list-group-item-danger">${w}</li>`; });
                    html += '</ul>';
                }
                if (result.recommendations && result.recommendations.length > 0) {
                    html += '<h6 class="mt-3">‚úÖ Recommendations</h6><ul class="list-group">';
                    result.recommendations.forEach(r => { html += `<li class="list-group-item list-group-item-success">${r}</li>`; });
                    html += '</ul>';
                }
                resultsContainer.innerHTML = html;
            } else {
                resultsContainer.innerHTML = `<p class="text-danger">Error: ${result.message}</p>`;
            }
        } catch (error) {
            resultsContainer.innerHTML = `<p class="text-danger">Failed to contact the AI Brain. Check your connection.</p>`;
            console.error("AI Fetch Error:", error);
        }
    });
});
</script>
            <p>&copy; 2025 Gorilla Camping. All Rights Reserved.</p>
            <p class="disclaimer">
                Guerilla-style affiliate marketing. Some links may earn us a small commission at no extra cost to you. 
                <a href="/as-is" class="footer-link">AS-IS Terms</a> | 
                <a href="/privacy" class="footer-link">Privacy Policy</a> | 
                <a href="/contact" class="footer-link">Contact</a>
            </p>
            <div class="footer-social">
                <p>Built with Flask, MongoDB & Pure Guerilla Hustle üèïÔ∏èüí™</p>
            </div>
        </div>
        <div class="legal-nav">
            <a href="/as-is">Terms</a>
            <a href="/privacy">Privacy</a>
            <a href="/contact">Contact</a>
        </div>
    </footer>

    <!-- Enhanced tracking scripts -->
    <script>
        // Affiliate link tracking
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.affiliate-link').forEach(function(link) {
                link.addEventListener('click', function(e) {
                    var affiliateUrl = this.getAttribute('href');
                    var productName = this.getAttribute('data-product') || 'Unknown Product';
                    
                    // Track with Google Analytics
                    if (typeof gtag !== '
ÓÄÄ
